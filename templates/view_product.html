{% extends "base.html" %}
{% block title %}{% if product %}{{ product.title }}{% else %}ìƒí’ˆ ì •ë³´{% endif %}{% endblock %}

{% block content %}
<div class="container mt-4">
    {% if product and not product.is_blocked %}
    <div class="card">
        <div class="card-header bg-white">
            <h2 class="mb-0">{{ product.title }}</h2>
        </div>
        {% if product.image %}
        <img src="{{ url_for('static', filename='uploads/' + product.image) }}" 
             class="card-img-top" alt="{{ product.title }}"
             style="max-height: 500px; object-fit: contain; padding: 20px;">
        {% endif %}
        <div class="card-body">
            <div class="card bg-light mb-4">
                <div class="card-body">
                    <h5 class="card-title">ìƒí’ˆ ì„¤ëª…</h5>
                    <p class="card-text" style="white-space: pre-wrap;">{{ product.description }}</p>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-md-6">
                    <p class="mb-0">
                        {% if product.is_free %}
                            <span class="badge badge-success">ë¬´ë£Œë‚˜ëˆ”</span>
                        {% else %}
                            <strong>ê°€ê²©:</strong> {{ product.price|format_price }}ì›
                        {% endif %}
                    </p>
                </div>
                <div class="col-md-6 text-md-right">
                    <p class="mb-0">
                        <strong>íŒë§¤ì:</strong> {{ seller.id }}
                    </p>
                </div>
            </div>
            
            {% if session.user_uuid and session.user_uuid != product.seller_uuid %}
                <form action="{{ url_for('start_chat', product_uuid=product.uuid) }}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-primary btn-lg btn-block">
                        ì±„íŒ…ìœ¼ë¡œ ê±°ë˜í•˜ê¸°
                    </button>
                </form>
            {% endif %}
            
            {% if session.user_uuid == product.seller_uuid %}
                <button class="btn btn-secondary btn-lg btn-block" disabled>ë‚´ ìƒí’ˆì…ë‹ˆë‹¤</button>
            {% endif %}
            
            {% if not session.user_uuid %}
                <a href="{{ url_for('login') }}" class="btn btn-primary btn-lg btn-block">ë¡œê·¸ì¸í•˜ê³  ì±„íŒ…í•˜ê¸°</a>
            {% endif %}
        </div>
    </div>

    <!-- ì‹ ê³ í•˜ê¸° ì„¹ì…˜ -->
    <div class="card mt-4">
        <div class="card-header bg-light">
            <h5 class="mb-0">ë¬¸ì œê°€ ìˆëŠ” ìƒí’ˆì¸ê°€ìš”?</h5>
        </div>
        <div class="card-body">
            <form action="{{ url_for('report') }}" method="post">
                <input type="hidden" name="target_id" value="{{ product.uuid }}">
                <input type="hidden" name="target_type" value="product">
                <div class="form-group">
                    <label for="reason"><strong>ì‹ ê³  ì‚¬ìœ :</strong></label>
                    <textarea name="reason" id="reason" class="form-control" rows="4" required></textarea>
                </div>
                <button type="submit" class="btn btn-danger">
                    ğŸ”” ì´ ìƒí’ˆ ì‹ ê³ í•˜ê¸°
                </button>
            </form>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}


